"use strict";(globalThis.webpackChunknotes=globalThis.webpackChunknotes||[]).push([[77725],{28453:(e,t,i)=>{i.d(t,{R:()=>r,x:()=>l});var s=i(96540);const n={},a=s.createContext(n);function r(e){const t=s.useContext(a);return s.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:r(e.components),s.createElement(a.Provider,{value:t},e.children)}},86199:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>r,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"ML General/Hierarchical Clustering","title":"Hierarchical Clustering","description":"notes from MIT","source":"@site/docs/05. ML General/30.Hierarchical Clustering.md","sourceDirName":"05. ML General","slug":"/p/bc2360e2-3cde-44dd-ad53-b5cddfd713e7","permalink":"/notes/docs/p/bc2360e2-3cde-44dd-ad53-b5cddfd713e7","draft":false,"unlisted":false,"editUrl":"https://github.com/emmableu/notes/edit/main/docs/05. ML General/30.Hierarchical Clustering.md","tags":[],"version":"current","sidebarPosition":30,"frontMatter":{"created_at":"2025-11-02","page_link":"/p/bc2360e2-3cde-44dd-ad53-b5cddfd713e7","slug":"/p/bc2360e2-3cde-44dd-ad53-b5cddfd713e7"},"sidebar":"tutorialSidebar","previous":{"title":"Support Vector Machine (SVM)","permalink":"/notes/docs/p/e4b13962-3bfd-4179-9f05-8389360f76b6"},"next":{"title":"EM Algorithm","permalink":"/notes/docs/p/c8f4884e-488f-4566-8b4d-690d0e062362"}}');var n=i(74848),a=i(28453);const r={created_at:"2025-11-02",page_link:"/p/bc2360e2-3cde-44dd-ad53-b5cddfd713e7",slug:"/p/bc2360e2-3cde-44dd-ad53-b5cddfd713e7"},l=void 0,c={},d=[{value:"Definition",id:"definition",level:2},{value:"hierarchical clustering v.s. K-means",id:"hierarchical-clustering-vs-k-means",level:2},{value:"Hierarchical clustering steps",id:"hierarchical-clustering-steps",level:2},{value:"Computing a proximity matrix",id:"computing-a-proximity-matrix",level:3},{value:"Similarity between Clusters",id:"similarity-between-clusters",level:3},{value:"Min (Single) Linkage",id:"min-single-linkage",level:4},{value:"Max (Complete) Linkage",id:"max-complete-linkage",level:4},{value:"Centroid Linkage",id:"centroid-linkage",level:4},{value:"Average Linkage",id:"average-linkage",level:4},{value:"Ward Linkage",id:"ward-linkage",level:4}];function o(e){const t={a:"a",br:"br",code:"code",h2:"h2",h3:"h3",h4:"h4",img:"img",li:"li",ol:"ol",p:"p",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.p,{children:(0,n.jsx)(t.a,{href:"http://web.mit.edu/6.S097/www/resources/Hierarchical.pdf",children:"notes from MIT"})}),"\n",(0,n.jsx)(t.h2,{id:"definition",children:"Definition"}),"\n",(0,n.jsx)(t.p,{children:"Hierarchical Clustering is an algorithm that iteratively cluster data samples into a hierarchical structure - a tree of clusters. It clusters data by iteratively merge clusters based on a similarity metric between clusters, such as min or max or average distance."}),"\n",(0,n.jsx)(t.h2,{id:"hierarchical-clustering-vs-k-means",children:"hierarchical clustering v.s. K-means"}),"\n",(0,n.jsx)(t.p,{children:"K-means tend to have the following issues:"}),"\n",(0,n.jsxs)(t.ol,{children:["\n",(0,n.jsx)(t.li,{children:"Convergence time is poor. For example K-means takes worst case exponential number (2^(\u2126(n))) of iterations."}),"\n",(0,n.jsx)(t.li,{children:"The final clusters depend heavily on the initialization. Usually a k random points are chosen."}),"\n",(0,n.jsx)(t.li,{children:"The number of clusters is a huge issue. You are forced to specify the number of clusters in the beginning."}),"\n"]}),"\n",(0,n.jsxs)(t.p,{children:["Hierarchical clustering solves all these issues and even allows you a metric by which to cluster.",(0,n.jsx)(t.br,{}),"\nHierarchical clustering is polynomial time, the final clusters are always the same depending on your metric, and the number of clusters is not at all a problem."]}),"\n",(0,n.jsx)(t.h2,{id:"hierarchical-clustering-steps",children:"Hierarchical clustering steps"}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.a,{href:"https://www.learndatasci.com/glossary/hierarchical-clustering/",children:"source"})}),"\n",(0,n.jsx)(t.p,{children:"Hierarchical clustering employs a measure of distance/similarity to create new clusters. It includes steps such as:"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"Step 1: Compute the proximity matrix using a particular distance metric (e.g., min distance)"}),"\n",(0,n.jsx)(t.li,{children:"Step 2: Each data point is assigned to a cluster"}),"\n",(0,n.jsx)(t.li,{children:"Step 3: Merge the clusters based on a metric for the similarity between clusters"}),"\n",(0,n.jsx)(t.li,{children:"Step 4: Update the distance matrix"}),"\n",(0,n.jsx)(t.li,{children:"Step 5: Repeat Step 3 and Step 4 until only a single cluster remains"}),"\n"]}),"\n",(0,n.jsx)(t.h3,{id:"computing-a-proximity-matrix",children:"Computing a proximity matrix"}),"\n",(0,n.jsxs)(t.p,{children:["The first step of the algorithm is to create a distance matrix. The values of the matrix are calculated by applying a distance function between each pair of objects. The ",(0,n.jsx)(t.strong,{children:"Euclidean distance function"})," is commonly used for this operation. The structure of the proximity matrix will be as follows for a data set with n elements. Here, represent the distance values between p_i and p_j"]}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{src:"https://raw.githubusercontent.com/emmableu/image/master/202210010143465.png",alt:""})}),"\n",(0,n.jsx)(t.h3,{id:"similarity-between-clusters",children:"Similarity between Clusters"}),"\n",(0,n.jsx)(t.p,{children:"The main question in hierarchical clustering is how to calculate the distance between clusters and update the proximity matrix. There are many different approaches used to answer that question. Each approach has its advantages and disadvantages. The choice will depend on whether there is noise in the data set, whether the shape of the clusters is circular or not, and the density of the data points."}),"\n",(0,n.jsx)(t.p,{children:"A numerical example will help illustrate the methods and choices. We'll use a small sample data set containing just nine two-dimensional points, displayed in Figure 1."}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{src:"https://storage.googleapis.com/lds-media/images/Sample-data-plot.width-1200.jpg",alt:""})}),"\n",(0,n.jsx)(t.p,{children:"Figure 1: Sample Data"}),"\n",(0,n.jsx)(t.p,{children:"Suppose we have two clusters in the sample data set, as shown in Figure 2. There are different approaches to calculate the distance between the clusters. Popular methods are listed below."}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{src:"https://storage.googleapis.com/lds-media/images/Sample-data-two-clusters-plot.width-1200.jpg",alt:""})}),"\n",(0,n.jsx)(t.p,{children:"Figure 2: Two clusters"}),"\n",(0,n.jsx)(t.h4,{id:"min-single-linkage",children:"Min (Single) Linkage"}),"\n",(0,n.jsxs)(t.p,{children:["One way to measure the distance between clusters is to find the minimum distance between points in those clusters. That is, we can find the point in the first cluster nearest to a point in the other cluster and calculate the distance between those points. In Figure 2, the closest points are p_2 in one cluster and p_5 in the other.  The distance between those points, and hence the distance between clusters, is found as ",(0,n.jsx)(t.code,{children:"d(p_2, p_5) = 4"}),"."]}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{src:"https://storage.googleapis.com/lds-media/images/Sample-data-min-distance-single-linkage.width-1200.jpg",alt:""})}),"\n",(0,n.jsx)(t.p,{children:"Figure 3: Min Linkage Method"}),"\n",(0,n.jsx)(t.p,{children:"The advantage of the Min method is that it can accurately handle non-elliptical shapes. The disadvantages are that it is sensitive to noise and outliers."}),"\n",(0,n.jsx)(t.h4,{id:"max-complete-linkage",children:"Max (Complete) Linkage"}),"\n",(0,n.jsx)(t.p,{children:"Another way to measure the distance is to find the maximum distance between points in two clusters. We can find the points in each cluster that are furthest away from each other and calculate the distance between those points. In Figure 3, the maximum distance is between p1 and p6. Distance between those two points, and hence the distance between clusters, is found as d(p1, p6) = 10."}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{src:"https://storage.googleapis.com/lds-media/images/Sample-data-max-distance-complete-linkage.width-1200.jpg",alt:""})}),"\n",(0,n.jsx)(t.p,{children:"Figure 4: Max Linkage Method"}),"\n",(0,n.jsx)(t.p,{children:"Max is less sensitive to noise and outliers in comparison to MIN method. However, MAX can break large clusters and tends to be biased towards globular clusters."}),"\n",(0,n.jsx)(t.h4,{id:"centroid-linkage",children:"Centroid Linkage"}),"\n",(0,n.jsx)(t.p,{children:"The Centroid method defines the distance between clusters as being the distance between their centers/centroids. After calculating the centroid for each cluster, the distance between those centroids is computed using a distance function."}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{src:"https://storage.googleapis.com/lds-media/images/Sample-data-centroid-distance-linkage.width-1200.jpg",alt:""})}),"\n",(0,n.jsx)(t.p,{children:"Figure 5: Centroid Linkage Method"}),"\n",(0,n.jsx)(t.h4,{id:"average-linkage",children:"Average Linkage"}),"\n",(0,n.jsx)(t.p,{children:"The Average method defines the distance between clusters as the average pairwise distance among all pairs of points in the clusters. For simplicity, only some of the lines connecting pairs of points are shown in Figure 6."}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{src:"https://storage.googleapis.com/lds-media/images/Sample-data-average-distance-linkage.width-1200.jpg",alt:""})}),"\n",(0,n.jsx)(t.p,{children:"Figure 6: Average Linkage Method"}),"\n",(0,n.jsx)(t.h4,{id:"ward-linkage",children:"Ward Linkage"}),"\n",(0,n.jsx)(t.p,{children:"The Ward approach analyzes the variance of the clusters rather than measuring distances directly, minimizing the variance between clusters."}),"\n",(0,n.jsx)(t.p,{children:"With the Ward method, the distance between two clusters is related to how much the sum of squares (SS) value will increase when combined."}),"\n",(0,n.jsx)(t.p,{children:"In other words, the Ward method attempts to minimize the sum of the squared distances of the points from the cluster centers. Compared to the distance-based measures described above, the Ward method is less susceptible to noise and outliers. Therefore, Ward's method is preferred more than others in clustering."})]})}function h(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(o,{...e})}):o(e)}}}]);