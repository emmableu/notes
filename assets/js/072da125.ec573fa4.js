"use strict";(globalThis.webpackChunknotes=globalThis.webpackChunknotes||[]).push([[38607],{28453:(e,t,n)=>{n.d(t,{R:()=>r,x:()=>s});var d=n(96540);const o={},a=d.createContext(o);function r(e){const t=d.useContext(a);return d.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function s(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:r(e.components),d.createElement(a.Provider,{value:t},e.children)}},52420:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>i,contentTitle:()=>s,default:()=>f,frontMatter:()=>r,metadata:()=>d,toc:()=>l});const d=JSON.parse('{"id":"Leetcode/Segment Tree/729.729 - My Calendar I - Medium","title":"729.729 - My Calendar I - Medium","description":"tags: [Binary Search, Design, Segment Tree, Ordered Set]","source":"@site/docs/03. Leetcode/13.Segment Tree/729.729 - My Calendar I - Medium.md","sourceDirName":"03. Leetcode/13.Segment Tree","slug":"/p/5a64f480-1ea9-4085-b8bd-7a9d7f30b207","permalink":"/notes/docs/p/5a64f480-1ea9-4085-b8bd-7a9d7f30b207","draft":false,"unlisted":false,"editUrl":"https://github.com/emmableu/notes/edit/main/docs/03. Leetcode/13.Segment Tree/729.729 - My Calendar I - Medium.md","tags":[],"version":"current","frontMatter":{"created_at":"2025-10-23","page_link":"/p/5a64f480-1ea9-4085-b8bd-7a9d7f30b207","slug":"/p/5a64f480-1ea9-4085-b8bd-7a9d7f30b207"},"sidebar":"tutorialSidebar","previous":{"title":"715.715 - Range Module - Hard","permalink":"/notes/docs/p/6490f1a8-40ff-4995-84f5-3b54819c37c6"},"next":{"title":"731.731 - My Calendar II - Medium","permalink":"/notes/docs/p/0036334e-b8c4-4741-ae0f-e78d6fa197fc"}}');var o=n(74848),a=n(28453);const r={created_at:"2025-10-23",page_link:"/p/5a64f480-1ea9-4085-b8bd-7a9d7f30b207",slug:"/p/5a64f480-1ea9-4085-b8bd-7a9d7f30b207"},s=void 0,i={},l=[];function c(e){const t={a:"a",code:"code",img:"img",p:"p",pre:"pre",...(0,a.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(t.p,{children:"tags: [Binary Search, Design, Segment Tree, Ordered Set]"}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.a,{href:"https://leetcode.cn/problems/my-calendar-i/",children:"LC Link"})}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.img,{src:"https://raw.githubusercontent.com/emmableu/image/master/202208091310545.png",alt:""})}),"\n",(0,o.jsxs)(t.p,{children:["\u8be6\u7ec6\u89e3\u7b54\u89c1 ",(0,o.jsx)(t.a,{href:"https://emmableu.github.io/blog/pages/060d0d/",children:"my calendar III"})]}),"\n",(0,o.jsx)(t.p,{children:"\u6ce8\u610f\u4e0d\u8981\u628a query \u548c update\u5199\u5728\u4e00\u8d77\uff0c\u5199\u5728\u4e00\u8d77\u7684\u65f6\u5019\u4f1a\u6709side effect"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-python",children:"class SegmentNode:\n\tdef __init__(self):\n\t\tself.left = None\n\t\tself.right = None\n\t\tself.can_book = 1\n\t\tself.add = 0\n\t\t\nclass MyCalendar:\n\tdef __init__(self):\n\t\tself.max_len = 10 ** 9\n\t\tself.root = SegmentNode()\n\n\tdef book(self, start: int, end: int) -> bool:\n\t\tcan_book = self.query(self.root, 0, self.max_len, start, end - 1)\n\t\tif can_book:\n\t\t\tself.update(self.root, 0, self.max_len, start, end - 1)\n\t\treturn bool(can_book)\n\n\tdef query(self, node: SegmentNode, start: int, end: int, lb: int, ub: int):\n\t\tif lb <= start and end <= ub:\n\t\t\treturn node.can_book\n\t\tself.push_down(node)\n\t\tcan_book = 1\n\t\tmid = (start + end) // 2\n\t\tif lb <= mid:\n\t\t\tcan_book &= self.query(node.left, start, mid, lb, ub)\n\t\t\tif not can_book:\n\t\t\t\treturn False\n\t\tif ub > mid:\n\t\t\tcan_book &= self.query(node.right, mid + 1, end, lb, ub)\n\t\treturn can_book\n\n\tdef update(self, node: SegmentNode, start: int, end: int, lb: int, ub: int):\n\t\tif lb <= start and end <= ub:\n\t\t\tnode.can_book = 0\n\t\t\tnode.add = 1\n\t\t\treturn\n\t\tself.push_down(node)\n\t\tmid = (start + end) // 2\n\t\tif lb <= mid:\n\t\t\tself.update(node.left, start, mid, lb, ub)\n\t\tif ub > mid:\n\t\t\tself.update(node.right, mid + 1, end, lb, ub)\n\t\tnode.can_book = node.left.can_book & node.right.can_book\n\n\t\t\n\tdef push_down(self, node):\n\t\tif not node.left:\n\t\t\tnode.left = SegmentNode()\n\t\tif not node.right:\n\t\t\tnode.right = SegmentNode()\n\t\tif not node.add:\n\t\t\treturn \n\t\tnode.left.can_book = 0\n\t\tnode.right.can_book = 0\n\t\tnode.left.add = 1\n\t\tnode.right.add = 1\n\t\tnode.add = 0\n"})})]})}function f(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,o.jsx)(t,{...e,children:(0,o.jsx)(c,{...e})}):c(e)}}}]);