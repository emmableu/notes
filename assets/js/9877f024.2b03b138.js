"use strict";(self.webpackChunknotes=self.webpackChunknotes||[]).push([[110],{28453:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>r});var s=t(96540);const l={},d=s.createContext(l);function o(e){const n=s.useContext(d);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:o(e.components),s.createElement(d.Provider,{value:n},e.children)}},70310:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>a,contentTitle:()=>r,default:()=>f,frontMatter:()=>o,metadata:()=>s,toc:()=>i});const s=JSON.parse('{"id":"Leetcode/Segment Tree/732.732 - My Calendar III (Hard)","title":"732.732 - My Calendar III (Hard)","description":"LC link","source":"@site/docs/Leetcode/13.Segment Tree/732.732 - My Calendar III (Hard).md","sourceDirName":"Leetcode/13.Segment Tree","slug":"/p/9d90fe71-0154-4248-bd74-2b6619c93c11","permalink":"/notes/docs/p/9d90fe71-0154-4248-bd74-2b6619c93c11","draft":false,"unlisted":false,"editUrl":"https://github.com/emmableu/notes/edit/main/docs/Leetcode/13.Segment Tree/732.732 - My Calendar III (Hard).md","tags":[],"version":"current","frontMatter":{"created_at":"2025-10-23","page_link":"/p/9d90fe71-0154-4248-bd74-2b6619c93c11","slug":"/p/9d90fe71-0154-4248-bd74-2b6619c93c11"},"sidebar":"tutorialSidebar","previous":{"title":"731.731 - My Calendar II - Medium","permalink":"/notes/docs/p/0036334e-b8c4-4741-ae0f-e78d6fa197fc"},"next":{"title":"14.Shuffle Algorithm","permalink":"/notes/docs/category/14shuffle-algorithm"}}');var l=t(74848),d=t(28453);const o={created_at:"2025-10-23",page_link:"/p/9d90fe71-0154-4248-bd74-2b6619c93c11",slug:"/p/9d90fe71-0154-4248-bd74-2b6619c93c11"},r=void 0,a={},i=[{value:"solution 1 (preferred): segment tree \u7ebf\u6bb5\u6811",id:"solution-1-preferred-segment-tree-\u7ebf\u6bb5\u6811",level:2},{value:"solution 2: \u4e0a\u4e0b\u8f66\u95ee\u9898",id:"solution-2-\u4e0a\u4e0b\u8f66\u95ee\u9898",level:2},{value:"\u590d\u4e60\u4e00\u4e0bmeeting room 2 \u7684\u4f2a\u4ee3\u7801",id:"\u590d\u4e60\u4e00\u4e0bmeeting-room-2-\u7684\u4f2a\u4ee3\u7801",level:3},{value:"\u672c\u9898\u4f2a\u4ee3\u7801",id:"\u672c\u9898\u4f2a\u4ee3\u7801",level:3},{value:"code",id:"code",level:3}];function c(e){const n={a:"a",br:"br",code:"code",h2:"h2",h3:"h3",img:"img",p:"p",pre:"pre",...(0,d.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.a,{href:"https://leetcode.com/problems/my-calendar-iii/",children:"LC link"}),(0,l.jsx)(n.br,{}),"\n",(0,l.jsx)(n.a,{href:"https://leetcode.com/problems/my-calendar-iii/discuss/290972/python-bisect-98",children:"explanation"}),(0,l.jsx)(n.br,{}),"\n\u7c7b\u4f3c\u9898\uff1a ",(0,l.jsx)(n.a,{href:"https://emmableu.github.io/blog/pages/7c87c4/",children:"meeting room ii"}),(0,l.jsx)(n.br,{}),"\n",(0,l.jsx)(n.img,{src:"https://raw.githubusercontent.com/emmableu/image/master/732-0.png",alt:""})]}),"\n",(0,l.jsx)(n.h2,{id:"solution-1-preferred-segment-tree-\u7ebf\u6bb5\u6811",children:"solution 1 (preferred): segment tree \u7ebf\u6bb5\u6811"}),"\n",(0,l.jsxs)(n.p,{children:["\u4ee5 root \u662f [0, 50]\u4e3a\u4f8b \uff08\u5176\u5b9e\u4e0d\u662f\uff0c\u5176\u5b9e\u662f[0, 10^9]), \u5982\u679c book([10, 20]), \u76ee\u6807\u662f\u901a\u8fc7\u7ebf\u6bb5\u6811\uff0c\u6700\u540e\u8fbe\u5230\u4e00\u4e2a\u957f\u6210\u8fd9\u6837\u5b50\u7684tree\uff1a\n",(0,l.jsx)(n.img,{src:"https://raw.githubusercontent.com/emmableu/image/master/202207212243564.png",alt:""})]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-python",children:"class SegmentNode():\n\tdef __init__(self):\n\t\tself.left = None\n\t\tself.right = None\n\t\tself.val = 0\n\t\tself.add = 0\n\nclass MyCalendarThree():\n\tdef __init__(self):\n\t\tself.max_len = 10**9\n\t\tself.root = SegmentNode()\n\n\tdef book(self, start, end):\n\t\tself.update(self.root, 0, self.max_len, start, end - 1)\n\t\treturn self.root.val\n\n\tdef update(self, node, lb, ub, l, r):\n\t\tif l <= lb and ub <= r:\n\t\t\tnode.val += 1\n\t\t\tnode.add += 1\n\t\t\treturn \n\t\tself.push_down(node)\n\t\tmid = (lb + ub) // 2\n\t\tif l <= mid:\n\t\t\tself.update(node.left, lb, mid, l, r)\n\t\tif r > mid:\n\t\t\tself.update(node.right, mid + 1, ub, l, r)\n\t\tself.push_up(node)\n\t\t\n\tdef push_up(self, node):\n\t\tnode.val = max(node.left.val, node.right.val)\n\t\n\tdef push_down(self, node):\n\t\tif node.left is None:\n\t\t\tnode.left = SegmentNode()\n\t\tif node.right is None:\n\t\t\tnode.right = SegmentNode()\n\t\t# \u5982\u679cadd \u4e3a0\uff0c\u8868\u793a\u6ca1\u6709\u6807\u8bb0\n\t\tif node.add == 0: \n\t\t\treturn \n\t\tnode.left.val += node.add \n\t\tnode.right.val += node.add \n\t\t\n\t\t# \u628a\u6807\u8bb0\u4e0b\u63a8\u7ed9\u5b69\u5b50\u8282\u70b9\n\t\t# \u5bf9\u533a\u95f4\u8fdb\u884c\u300c\u52a0\u51cf\u300d\u7684\u66f4\u65b0\u64cd\u4f5c\uff0c\u4e0b\u63a8\u61d2\u60f0\u6807\u8bb0\u65f6\u9700\u8981\u7d2f\u52a0\u8d77\u6765\uff0c\u4e0d\u80fd\u76f4\u63a5\u8986\u76d6\n\t\tnode.left.add += node.add\n\t\tnode.right.add += node.add\n\t\t# \u53d6\u6d88\u5f53\u524d\u8282\u70b9\u6807\u8bb0\n\t\tnode.add = 0 \n"})}),"\n",(0,l.jsx)(n.h2,{id:"solution-2-\u4e0a\u4e0b\u8f66\u95ee\u9898",children:"solution 2: \u4e0a\u4e0b\u8f66\u95ee\u9898"}),"\n",(0,l.jsx)(n.h3,{id:"\u590d\u4e60\u4e00\u4e0bmeeting-room-2-\u7684\u4f2a\u4ee3\u7801",children:"\u590d\u4e60\u4e00\u4e0bmeeting room 2 \u7684\u4f2a\u4ee3\u7801"}),"\n",(0,l.jsxs)(n.p,{children:["\u4ee5 ",(0,l.jsx)(n.code,{children:"[[0,30],[5,10],[15,20]]"})," \u4e3a\u4f8b\uff1a"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-python",children:"def minMeetingRooms(intervals):\n    \n    1. \u628a\u6240\u6709\u7684\u5f00\u59cb\u65f6\u95f4\u548c\u7ed3\u675f\u65f6\u95f4\u653e\u5728\u4e00\u8d77\u6392\u5e8f\uff1a\n            events =  [(iv[0], 1) for iv in intervals] \\\n                        + [(iv[1], -1) for iv in intervals]\n            \u5f97\u5230events = [(0,1),(5,1),(10,-1),(15,1), (20,-1), (30,-1)]\n    \n    2. \u7528cur\u8868\u793a\u5f53\u524d\u8fdb\u884c\u7684\u4f1a\u8bae\u6570\u91cf\uff0c\u904d\u5386\u6392\u5e8f\u540e\u7684\u65f6\u95f4\u6570\u7ec4 events, \n        \u5982\u679c\u662f\u5f00\u59cb\u65f6\u95f4\uff0ccur\u52a01 (\u8868\u793a\u51fa\u73b0\u4e86\u4e00\u4e2a\u65b0\u7684\u4f1a\u8bae\uff0c\u5f00\u4e00\u4e2a\u65b0\u7684\u4f1a\u8bae\u5ba4\uff09\uff0c\n        \u5982\u679c\u662f\u7ed3\u675f\u65f6\u95f4\uff0ccur\u51cf\u4e00 \uff08\u8868\u793a\u7ed3\u675f\u4e86\u4e00\u4e2a\u4f1a\u8bae\uff0c\u5173\u4e00\u4e2a\u4f1a\u8bae\u5ba4\uff09\n      \n      \u5728\u904d\u5386\u7684\u8fc7\u7a0b\u4e2d\uff0ccur\u51fa\u73b0\u7684\u6700\u5927\u503c\u5c31\u662f\u9700\u8981\u7684\u623f\u95f4\u6570\u3002\n"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"room\u6570 1    2     1     2     1      0\n       0----5----10----15----20-----30\n\u53d8\u5316   +1   +1    -1    +1    -1    -1\n"})}),"\n",(0,l.jsx)(n.h3,{id:"\u672c\u9898\u4f2a\u4ee3\u7801",children:"\u672c\u9898\u4f2a\u4ee3\u7801"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-python",children:"class MyCalendarThree(object):\n    def __init__(self):\n        self.pos = []\n        self.delta = {}\n        self.maxn = 0\n\n    \u4ee5\u5f53\u524ddelta = {10:1, 20:0}, \u5f53\u524d\u7684pos = [10, 20], \n    \u63d2\u5165\u7684start\uff0cend \u4e3a 15\uff0c30\uff0c\u4e3a\u4f8b\n    def book(self, start, end):\n        \u627e\u5230start \u5728 self.pos \u91cc\u9762\u5c3d\u91cf\u5de6\u7684\u63d2\u5165\u70b9\uff1a\n            \uff08i = bisect.bisect_left(self.pos, start)\uff09\n            \u5f97\u5230 i = 1\n\n        \u5982\u679cstart \u4e0d\u5728 delta\u91cc\u9762\uff0c\u5c31\u628astart\u653e\u8fdb delta \u548c pos\u91cc\u9762, \n        start \u5bf9\u5e94\u7684value \u548c\u4ed6\u5728pos\u91cc\u9762\u4e0a\u4e00\u4e2a\u6570\u5b57\uff0810\uff09\u5bf9\u5e94\u7684value\u4e00\u6837\uff08\u5c31\u662f1\uff09\n            delta \u4ece  {10:1, 20:0}  \u53d8\u6210  {10:1, 20:0, 15:1} \n            \u4e5f\u5c31\u662f {10:1, 15:1\uff0c20:0}\n            pos \u4ece [10, 20] \u53d8\u6210 [10, 15, 20]\n\n        \u627e\u5230end \u5728 self.pos \u91cc\u9762\u5c3d\u91cf\u53f3\u7684\u63d2\u5165\u70b9\uff1a\n            \uff08j = bisect.bisect_right(self.pos, end)\uff09\n            \u5f97\u5230 j = 3\n\n        \u5982\u679c end \u4e0d\u5728 delta\u91cc\u9762\uff0c\u5c31\u628a end \u653e\u8fdb delta \u548c pos\u91cc\u9762\uff1a\n        end \u5bf9\u5e94\u7684value \u548c\u4ed6\u5728pos\u91cc\u9762\u4e0a\u4e00\u4e2a\u6570\u5b57\uff0820\uff09\u5bf9\u5e94\u7684value\u4e00\u6837\uff08\u5c31\u662f0\uff09\n            delta \u4ece   {10:1, 15:1\uff0c20:0}  \u53d8\u6210  {10:1, 15:1, 20:0, 30:0}\n            pos \u4ece [10, 20] \u53d8\u6210 [10, 15, 20, 30]\n\n        \u56e0\u4e3a\u52a0\u5165\u4e86\u8fd9\u4e9b\u65b0\u7684\u503c\u4ee5\u540e\uff0c[i, j) \u533a\u95f4\u5185\u591a\u4e86\u4e00\u4e2abooking\uff0c\u6240\u4ee5\n        delta \u4ece15\u5f00\u59cb\uff0c\u4e00\u76f4\u523030 \u4f46\u4e0d\u5305\u62ec30\u5bf9\u5e94\u7684\u503c\u8981 + 1\n        delta \u53d8\u6210\u4e86 {10:1, 15:2, 20:1, 30:0}\n        \u540c\u65f6\u66f4\u65b0maxn,\u662f\u5f53\u524d\u5b57\u5178\u91cc\u6700\u5927\u7684val\uff0c\u5373\u68c0\u67e5\u65b0\u7684\u533a\u95f4\u91cc\u6709\u6ca1\u6709\u4ea7\u751f\u66f4\u5927\u7684max\n        \u89c1\u4ee3\u7801\n        for k in range(i, j):\n            self.delta[self.pos[k]] = c = self.delta[self.pos[k]] + 1\n            self.maxn = max(self.maxn, c)\n        print(self.delta, start, end)\n        return self.maxn\n"})}),"\n",(0,l.jsx)(n.h3,{id:"code",children:"code"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-python",children:"class MyCalendarThree(object):\n    def __init__(self):\n        self.pos = []\n        self.delta = {}\n        self.maxn = 0\n\n    def book(self, start, end):\n        i = bisect.bisect_left(self.pos, start)\n\n        if start not in self.delta:\n            self.delta[start] = self.delta[self.pos[i-1]] if i else 0\n            self.pos[i:i] = [start]\n\n        j = bisect.bisect_left(self.pos, end)\n        if end not in self.delta:\n            self.delta[end] = self.delta[self.pos[j-1]]\n            self.pos[j:j] = [end]\n\n        for k in range(i, j):\n            self.delta[self.pos[k]] = c = self.delta[self.pos[k]] + 1\n            self.maxn = max(self.maxn, c)\n\n        return self.maxn\n"})})]})}function f(e={}){const{wrapper:n}={...(0,d.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(c,{...e})}):c(e)}}}]);