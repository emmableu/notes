"use strict";(globalThis.webpackChunknotes=globalThis.webpackChunknotes||[]).push([[35616],{22916:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>i,contentTitle:()=>r,default:()=>c,frontMatter:()=>s,metadata:()=>d,toc:()=>l});const d=JSON.parse('{"id":"Leetcode/Segment Tree/731.731 - My Calendar II - Medium","title":"731.731 - My Calendar II - Medium","description":"LC Link","source":"@site/docs/03. Leetcode/13.Segment Tree/731.731 - My Calendar II - Medium.md","sourceDirName":"03. Leetcode/13.Segment Tree","slug":"/p/0036334e-b8c4-4741-ae0f-e78d6fa197fc","permalink":"/notes/docs/p/0036334e-b8c4-4741-ae0f-e78d6fa197fc","draft":false,"unlisted":false,"editUrl":"https://github.com/emmableu/notes/edit/main/docs/03. Leetcode/13.Segment Tree/731.731 - My Calendar II - Medium.md","tags":[],"version":"current","frontMatter":{"created_at":"2025-10-23","page_link":"/p/0036334e-b8c4-4741-ae0f-e78d6fa197fc","slug":"/p/0036334e-b8c4-4741-ae0f-e78d6fa197fc"},"sidebar":"tutorialSidebar","previous":{"title":"729.729 - My Calendar I - Medium","permalink":"/notes/docs/p/5a64f480-1ea9-4085-b8bd-7a9d7f30b207"},"next":{"title":"732.732 - My Calendar III (Hard)","permalink":"/notes/docs/p/9d90fe71-0154-4248-bd74-2b6619c93c11"}}');var o=n(74848),a=n(28453);const s={created_at:"2025-10-23",page_link:"/p/0036334e-b8c4-4741-ae0f-e78d6fa197fc",slug:"/p/0036334e-b8c4-4741-ae0f-e78d6fa197fc"},r=void 0,i={},l=[];function f(e){const t={a:"a",code:"code",img:"img",p:"p",pre:"pre",...(0,a.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(t.p,{children:(0,o.jsx)(t.a,{href:"https://leetcode.cn/problems/my-calendar-ii/",children:"LC Link"})}),"\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.img,{src:"https://raw.githubusercontent.com/emmableu/image/master/202208252343236.png",alt:""}),"\n",(0,o.jsx)(t.img,{src:"https://raw.githubusercontent.com/emmableu/image/master/202208252344129.png",alt:""}),"\n\u6ce8\u610f\u5728pushdown\u7684\u65f6\u5019\u4e0d\u80fd\u5199\uff1a"]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-python",children:"\t\t\tnode.left.time_left = node.time_left\n\t\t\tnode.right.time_left = node.time_left\n"})}),"\n",(0,o.jsx)(t.p,{children:"\u8fd9\u6837\u7684\u8bdd\u5982\u679c 10-40 \u662ftime_booked = 2, \u90a3\u4e48\u4e0b\u9762\u6240\u6709\u7684\u90fd\u4f1a\u66f4\u65b0\u6210 time_booked = 2,\u4f46\u5176\u5b9e\u6709\u4e9b\u662f1"}),"\n",(0,o.jsx)(t.p,{children:"\u4e0b\u63a8\u61d2\u60f0\u6807\u8bb0\u65f6\u9700\u8981\u7d2f\u52a0\u8d77\u6765\uff0c\u4e0d\u80fd\u76f4\u63a5\u8986\u76d6"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-python",children:"class SegmentNode:\n\tdef __init__(self):\n\t\tself.left = None\n\t\tself.right = None\n\t\tself.time_booked = 0\n\t\tself.add = 0\n\nclass MyCalendarTwo:\n\n\tdef __init__(self):\n\t\tself.max_len = 10 ** 9\n\t\tself.root = SegmentNode()\n\n\n\tdef book(self, start: int, end: int) -> bool:\n\t\ttime_booked = self.query(self.root, 0, self.max_len, start, end - 1)\n\t\tif time_booked < 2:\n\t\t\tself.update(self.root, 0, self.max_len, start, end - 1)\n\t\t\treturn True\n\t\telse:\n\t\t\treturn False\n\n\tdef update(self, node, start, end, lb, ub):\n\t\tif lb <= start and end <= ub:\n\t\t\tnode.time_booked += 1\n\t\t\tnode.add += 1\n\t\t\treturn\n\t\tself.push_down(node)\n\t\tmid = (start + end) // 2\n\t\tif lb <= mid:\n\t\t\tself.update(node.left, start, mid, lb, ub)\n\t\tif ub > mid:\n\t\t\tself.update(node.right, mid + 1, end, lb, ub)\n\t\tself.push_up(node)\n\t\n\t\n\tdef query(self, node, start, end, lb, ub):\n\t\tif lb <= start and end <= ub:\n\t\t\treturn node.time_booked\n\t\tself.push_down(node)\n\t\tres = 0\n\t\tmid = (start + end)\t// 2\n\t\tif lb <= mid:\n\t\t\tres = max(res, self.query(node.left, start, mid, lb, ub))\n\t\tif ub > mid:\n\t\t\tres = max(res, self.query(node.right, mid + 1, end, lb, ub))\n\t\treturn res\n\n\tdef push_up(self, node):\n\t\tnode.time_booked = max(node.left.time_booked, node.right.time_booked)\n\t\n\tdef push_down(self, node):\n\t\tif not node.left:\n\t\t\tnode.left = SegmentNode()\n\t\tif not node.right:\n\t\t\tnode.right = SegmentNode()\n\t\tif node.add:\n\t\t\tnode.left.time_booked += node.add\n\t\t\tnode.right.time_booked += node.add\n\t\t\tnode.left.add += node.add\n\t\t\tnode.right.add += node.add\n\t\t\tnode.add = 0\n\n# Your MyCalendarTwo object will be instantiated and called as such:\n# obj = MyCalendarTwo()\n# param_1 = obj.book(start,end)\n"})})]})}function c(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,o.jsx)(t,{...e,children:(0,o.jsx)(f,{...e})}):f(e)}},28453:(e,t,n)=>{n.d(t,{R:()=>s,x:()=>r});var d=n(96540);const o={},a=d.createContext(o);function s(e){const t=d.useContext(a);return d.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function r(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:s(e.components),d.createElement(a.Provider,{value:t},e.children)}}}]);